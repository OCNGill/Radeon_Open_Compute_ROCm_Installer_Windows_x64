<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <ComponentGroup Id="DevToolsComponents">
      <ComponentRef Id="DevToolsShortcuts" />
    <ComponentRef Id="DiagnosticTools" />
    </ComponentGroup>

    <DirectoryRef Id="INSTALLFOLDER">
      <Directory Id="ToolsFolder" Name="tools">
        <Component Id="DiagnosticTools" Guid="{A1B2C3D4-E5F6-7890-ABCD-EF1234567890}">
       <!-- Placeholder for diagnostic utilities -->
    <File Id="rocminfo_link.txt" Source="..\src\scripts\detect_hardware.ps1" KeyPath="yes" />
          <File Id="amd_compatibility.txt" Source="..\src\scripts\verify_amd_compatibility.ps1" />
          <File Id="driver_check.txt" Source="..\src\scripts\check_amd_driver.ps1" />
          
          <!-- Environment variable for tools -->
<Environment Id="PATH_Tools" 
      Name="PATH" 
       Value="[ToolsFolder]" 
  Permanent="no" 
   Part="last" 
     Action="set" 
           System="yes" />
        </Component>
      </Directory>
    </DirectoryRef>

    <DirectoryRef Id="ApplicationProgramsFolder">
  <Component Id="DevToolsShortcuts" Guid="{B2C3D4E5-F6G7-8901-BCDE-F12345678901}">
<Shortcut Id="DiagnosticsShortcut"
        Name="ROCm Diagnostics"
                  Description="Run ROCm diagnostic tools"
    Target="[WindowsFolder]System32\wsl.exe"
                  Arguments="-d Ubuntu-22.04 rocminfo"
       WorkingDirectory="INSTALLFOLDER" />
        
        <Shortcut Id="AMDSMIShortcut"
           Name="AMD System Management Interface"
             Description="AMD GPU management and monitoring"
       Target="[WindowsFolder]System32\wsl.exe"
     Arguments="-d Ubuntu-22.04 amd-smi"
   WorkingDirectory="INSTALLFOLDER" />

        <RemoveFolder Id="RemoveDevToolsShortcuts" On="uninstall" />
        <RegistryValue Root="HKCU" 
Key="Software\ROCm\DevTools" 
         Name="installed" 
      Type="integer" 
            Value="1" 
    KeyPath="yes" />
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
